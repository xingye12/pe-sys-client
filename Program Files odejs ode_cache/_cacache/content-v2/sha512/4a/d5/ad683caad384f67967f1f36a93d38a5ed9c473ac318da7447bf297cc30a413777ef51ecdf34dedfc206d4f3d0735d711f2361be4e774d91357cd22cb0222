{"_attachments":{},"_id":"bidi-js","_rev":"916044-61f288d245d527a190cb8bd8","author":{"name":"Jason Johnston"},"description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","dist-tags":{"latest":"1.0.3"},"license":"MIT","maintainers":[{"name":"lojjic","email":"jason@lojjic.com"}],"name":"bidi-js","readme":"# bidi-js\n\nThis is a pure JavaScript implementation of the [Unicode Bidirectional Algorithm](https://www.unicode.org/reports/tr9/) version 13.0.0. Its goals, in no particular order, are to be:\n\n* Correct\n* Small\n* Fast\n\n\n## Conformance\n\nThis implementation currently conforms to section [UAX-C1](https://unicode.org/reports/tr9/#C1) of the bidi spec, as verified by running all the provided [conformance tests](https://unicode.org/reports/tr9/#Bidi_Conformance_Testing).\n\n## Compatibility\n\nIt has no external dependencies and therefore should run just fine in any relatively capable web browser, Node.js, etc. The provided distribution `.js` files are valid ES5.\n\n## Usage\n\nInstall it from npm:\n\n```shell\nnpm install bidi-js\n```\n\n[![NPM](https://nodei.co/npm/bidi-js.png?compact=true)](https://npmjs.org/package/bidi-js)\n\nImport and initialize:\n\n```js\nimport bidiFactory from 'bidi-js'\n// or: const bidiFactory = require('bidi-js')\n\nconst bidi = bidiFactory()\n```\n\nThe `bidi-js` package's only export is a factory function which you _must invoke_ to return a `bidi` object; that object exposes the methods for bidi processing.\n\n(_Why a factory function?_ The main reason is to ensure the entire module's code is wrapped within a single self-contained function with no closure dependencies. This enables that function to be stringified and passed into a web worker, for example.)\n\nNow that you have the `bidi` object, you can:\n\n### Calculate bidi embedding levels\n\n```js\nconst embeddingLevels = bidi.getEmbeddingLevels(\n  text, //the input string containing mixed-direction text\n  explicitDirection //\"ltr\" or \"rtl\" if you don't want to auto-detect it\n)\n\nconst { levels, paragraphs } = embeddingLevels\n```\n\nThe result object `embeddingLevels` will usually be passed to other functions described below. Its contents, should you need to inspect them individually, are:\n\n* `levels` is a `Uint8Array` holding the calculated [bidi embedding levels](https://unicode.org/reports/tr9/#BD2) for each character in the string. The most important thing to know about these levels is that any given character is in a right-to-left scope if its embedding level is an odd number, and left-to-right if it's an even number.\n\n* `paragraphs` is an array of `{start, end, level}` objects, one for each paragraph in the text (paragraphs are separated by explicit breaking characters, not soft line wrapping). The `start` and `end` indices are inclusive, and `level` is the resolved base embedding level of that paragraph.\n\n### Calculate character reorderings\n\n```js\nconst flips = bidi.getReorderSegments(\n  text, //the full input string\n  embeddingLevels //the full result object from getEmbeddingLevels\n)\n\n// Process all reversal sequences, in order:\nflips.forEach(range => {\n  const [start, end] = range\n  // Reverse this sequence of characters from start to end, inclusive\n  for (let i = start; i <= end; i++) {\n    //...\n  }\n})\n```\n\nEach \"flip\" is a range that should be reversed in place; they must all be applied in order.\n\nSometimes you don't want to process the whole string at once, but just a particular substring. A common example would be if you've applied line wrapping, in which case you need to process each line individually (in particular this does some special handling for trailing whitespace for each line). For this you can pass the extra `start` and `end` parameters:\n\n```js\nyourWrappedLines.forEach(([lineStart, lineEnd]) => {\n  const flips = bidi.getReorderSegments(\n    text,\n    embeddingLevels,\n    lineStart,\n    lineEnd //inclusive\n  )\n  // ...process flips for this line\n})\n```\n\n### Handle right-to-left mirrored characters\n\nSome characters that resolve to right-to-left need to be swapped with their \"mirrored\" characters. Examples of this are opening/closing parentheses. You can determine all the characters that need to be mirrored like so:\n\n```js\nconst mirrored = bidi.getMirroredCharactersMap(\n  text,\n  embeddingLevels\n)\n```\n\nThis returns a `Map` of numeric character indices to replacement characters.\n\nYou can also process just a substring with extra `start` and `end` parameters:\n\n```js\nconst mirrored = bidi.getMirroredCharactersMap(\n  text,\n  embeddingLevels,\n  start,\n  end //inclusive\n)\n```\n\nIf you'd rather process mirrored characters individually, you can use the single `getMirroredCharacter` function, just make sure you only do it for right-to-left characters (those whose embedding level is an odd number.) It will return `null` if the character doesn't support mirroring.\n\n```js\nconst mirroredChar = (embeddingLevels.levels[charIndex] & 1) //odd number means RTL\n    ? bidi.getMirroredCharacter(text[charIndex])\n    : null\n```\n\n### Get a character's bidi type\n\nThis is used internally, but you can also ask for the [\"bidi character type\"](https://unicode.org/reports/tr9/#BD1) of any character, should you need it:\n\n```js\nconst bidiType = bidi.getBidiCharTypeName(string[charIndex])\n// e.g. \"L\", \"R\", \"AL\", \"NSM\", ...\n```\n","time":{"created":"2022-01-27T11:58:10.523Z","modified":"2023-07-31T17:17:57.040Z","1.0.2":"2021-05-04T16:30:12.268Z","1.0.1":"2021-04-26T16:09:02.235Z","1.0.0":"2021-04-15T22:57:43.493Z","0.9.1":"2021-04-15T04:19:23.155Z","1.0.3":"2023-07-31T17:15:17.072Z"},"versions":{"1.0.2":{"name":"bidi-js","version":"1.0.2","description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","main":"dist/bidi.js","module":"dist/bidi.mjs","repository":{"type":"git","url":"git+https://github.com/lojjic/bidi-js.git"},"scripts":{"build":"rollup -c rollup.config.js","test":"npx babel-node --plugins @babel/plugin-transform-modules-commonjs test/runTestsOnSrc.js","test-build":"node test/runTestsOnBuild.js"},"author":{"name":"Jason Johnston"},"license":"MIT","devDependencies":{"@babel/cli":"^7.13.16","@babel/core":"^7.14.0","@babel/node":"^7.13.13","@babel/plugin-transform-modules-commonjs":"^7.13.8","@babel/preset-env":"^7.14.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-buble":"^0.21.3","node-fetch":"^2.6.1","rollup":"^2.45.1","rollup-plugin-terser":"^7.0.2"},"dependencies":{"require-from-string":"^2.0.2"},"gitHead":"b3b037b8d582b5a82c5dfc765b84029608b005e2","bugs":{"url":"https://github.com/lojjic/bidi-js/issues"},"homepage":"https://github.com/lojjic/bidi-js#readme","_id":"bidi-js@1.0.2","_nodeVersion":"14.15.1","_npmVersion":"6.14.8","dist":{"shasum":"1a497a762c2ddea377429d2649c9ce0f8a91527f","size":44726,"noattachment":false,"tarball":"https://registry.npmmirror.com/bidi-js/-/bidi-js-1.0.2.tgz","integrity":"sha512-rzSy/k7WdX5zOyeHHCOixGXbCHkyogkxPKL2r8QtzHmVQDiWCXUWa18bLdMWT9CYMLOYTjWpTHawuev2ouYJVw=="},"_npmUser":{"name":"lojjic","email":"jason+npm@lojjic.com"},"directories":{},"maintainers":[{"name":"lojjic","email":"jason+npm@lojjic.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/bidi-js_1.0.2_1620145812135_0.22169450371637245"},"_hasShrinkwrap":false,"publish_time":1620145812268,"_cnpm_publish_time":1620145812268,"_cnpmcore_publish_time":"2021-12-16T12:49:35.390Z"},"1.0.1":{"name":"bidi-js","version":"1.0.1","description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","main":"dist/bidi.js","module":"dist/bidi.mjs","repository":{"type":"git","url":"git+https://github.com/lojjic/bidi-js.git"},"scripts":{"build":"rollup -c rollup.config.js","test":"npx babel-node --plugins @babel/plugin-transform-modules-commonjs test/index.js"},"author":{"name":"Jason Johnston"},"license":"MIT","devDependencies":{"@babel/core":"^7.13.16","@babel/node":"^7.13.13","@babel/plugin-transform-modules-commonjs":"^7.13.8","node-fetch":"^2.6.1","rollup":"^2.45.1","rollup-plugin-terser":"^7.0.2"},"gitHead":"03e86566ab6f00bb9cdd9ed414b16a46141c4758","bugs":{"url":"https://github.com/lojjic/bidi-js/issues"},"homepage":"https://github.com/lojjic/bidi-js#readme","_id":"bidi-js@1.0.1","_nodeVersion":"14.15.1","_npmVersion":"6.14.8","dist":{"shasum":"0fc5d53745b3a1d73a39157126426b7f699622ee","size":41708,"noattachment":false,"tarball":"https://registry.npmmirror.com/bidi-js/-/bidi-js-1.0.1.tgz","integrity":"sha512-h8SbFfrrcPhi6Lm+O67ozP+q1+L4TbMItIbH/OLXq4VTGytJHWjAxCXiSu7HHp6YFh+SCCdE1h2psoJ7OSO9tQ=="},"_npmUser":{"name":"lojjic","email":"jason+npm@lojjic.com"},"directories":{},"maintainers":[{"name":"lojjic","email":"jason+npm@lojjic.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/bidi-js_1.0.1_1619453342065_0.10624926225315479"},"_hasShrinkwrap":false,"publish_time":1619453342235,"_cnpm_publish_time":1619453342235,"_cnpmcore_publish_time":"2021-12-16T12:49:35.688Z"},"1.0.0":{"name":"bidi-js","version":"1.0.0","description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","main":"dist/bidi.js","module":"dist/bidi.mjs","type":"module","scripts":{"build":"rollup -c rollup.config.js","test":"node test/index.js"},"author":{"name":"Jason Johnston"},"license":"MIT","devDependencies":{"node-fetch":"^2.6.1","rollup":"^2.45.1","rollup-plugin-terser":"^7.0.2"},"gitHead":"81a5f61d40d022f335fdb7f76b1a2e89eaebbac8","_id":"bidi-js@1.0.0","_nodeVersion":"14.15.1","_npmVersion":"6.14.8","dist":{"shasum":"793b37635a12bf404494740fae5e9f877354b40f","size":41578,"noattachment":false,"tarball":"https://registry.npmmirror.com/bidi-js/-/bidi-js-1.0.0.tgz","integrity":"sha512-Hza9+ZqnUPeDYigxa7C9pByYzFxLJOgZDq+a1wX/5ikZRMKn0jI3IT8dC66gDrHD3a1UuiY+kiOHol+Ro0ay4w=="},"_npmUser":{"name":"lojjic","email":"jason+npm@lojjic.com"},"directories":{},"maintainers":[{"name":"lojjic","email":"jason+npm@lojjic.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/bidi-js_1.0.0_1618527463267_0.7089335739022145"},"_hasShrinkwrap":false,"publish_time":1618527463493,"_cnpm_publish_time":1618527463493,"_cnpmcore_publish_time":"2021-12-16T12:49:35.976Z"},"0.9.1":{"name":"bidi-js","version":"0.9.1","description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","main":"dist/bidi.js","type":"module","scripts":{"build":"rollup -c rollup.config.js","test":"node test/index.js"},"author":{"name":"Jason Johnston"},"license":"MIT","devDependencies":{"node-fetch":"^2.6.1","rollup":"^2.45.1","rollup-plugin-terser":"^7.0.2"},"gitHead":"a945b0a8947810dfecaf15c95e5cf8e273f2eba7","_id":"bidi-js@0.9.1","_nodeVersion":"14.15.1","_npmVersion":"6.14.8","dist":{"shasum":"85bbdf4f238246543cd7712038c0aa3050997af6","size":1729248,"noattachment":false,"tarball":"https://registry.npmmirror.com/bidi-js/-/bidi-js-0.9.1.tgz","integrity":"sha512-NKESLmgLk2FrFM6xqnK8JN5HRcnX6kitoGzY4CJMHhLzh5Lyj5OoimnAMR9Eeo0KhdKSqLZrO/GQW7HJaAtCtw=="},"_npmUser":{"name":"lojjic","email":"jason+npm@lojjic.com"},"directories":{},"maintainers":[{"name":"lojjic","email":"jason+npm@lojjic.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/bidi-js_0.9.1_1618460362939_0.029315538567881827"},"_hasShrinkwrap":false,"publish_time":1618460363155,"_cnpm_publish_time":1618460363155,"_cnpmcore_publish_time":"2021-12-16T12:49:39.646Z"},"1.0.3":{"name":"bidi-js","version":"1.0.3","description":"A JavaScript implementation of the Unicode Bidirectional Algorithm","main":"dist/bidi.js","module":"dist/bidi.mjs","repository":{"type":"git","url":"git+https://github.com/lojjic/bidi-js.git"},"scripts":{"build":"rollup -c rollup.config.js","test":"npx babel-node --plugins @babel/plugin-transform-modules-commonjs test/runTestsOnSrc.js","test-build":"node test/runTestsOnBuild.js"},"author":{"name":"Jason Johnston"},"license":"MIT","devDependencies":{"@babel/cli":"^7.13.16","@babel/core":"^7.14.0","@babel/node":"^7.13.13","@babel/plugin-transform-modules-commonjs":"^7.13.8","@babel/preset-env":"^7.14.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-buble":"^0.21.3","node-fetch":"^2.6.1","rollup":"^2.45.1","rollup-plugin-terser":"^7.0.2"},"dependencies":{"require-from-string":"^2.0.2"},"gitHead":"6a6cf306d3c8cbc6e62944665ab9289f2f3d8d2a","bugs":{"url":"https://github.com/lojjic/bidi-js/issues"},"homepage":"https://github.com/lojjic/bidi-js#readme","_id":"bidi-js@1.0.3","_nodeVersion":"16.14.0","_npmVersion":"8.19.2","dist":{"integrity":"sha512-RKshQI1R3YQ+n9YJz2QQ147P66ELpa1FQEg20Dk8oW9t2KgLbpDLLp9aGZ7y8WHSshDknG0bknqGw5/tyCs5tw==","shasum":"6f8bcf3c877c4d9220ddf49b9bb6930c88f877d2","tarball":"https://registry.npmmirror.com/bidi-js/-/bidi-js-1.0.3.tgz","fileCount":17,"unpackedSize":160810,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEYCIQC33ae/ZfDedA2XccqojMeUIEWWUbvlEjUfioMUBRLhIwIhAJtgssVlO43GN7Wufgn/mk2TpRSZkewgnj/Angsjje8V"}],"size":44565},"_npmUser":{"name":"lojjic","email":"jason@lojjic.com"},"directories":{},"maintainers":[{"name":"lojjic","email":"jason@lojjic.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/bidi-js_1.0.3_1690823716895_0.7293331484581933"},"_hasShrinkwrap":false,"_cnpmcore_publish_time":"2023-07-31T17:15:17.072Z","publish_time":1690823717072,"_source_registry_name":"default"}},"bugs":{"url":"https://github.com/lojjic/bidi-js/issues"},"homepage":"https://github.com/lojjic/bidi-js#readme","repository":{"type":"git","url":"git+https://github.com/lojjic/bidi-js.git"},"_source_registry_name":"default"}